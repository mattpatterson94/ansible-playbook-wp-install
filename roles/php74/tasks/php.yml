---
- name: Add the packages in sources lists
  become: true
  shell: wget -O /etc/apt/trusted.gpg.d/php.gpg https://packages.sury.org/php/apt.gpg
  when: ansible_os_family == 'Debian'

- name: Add the packages in sources lists
  become: true
  shell: sh -c 'echo "deb https://packages.sury.org/php/ $(lsb_release -sc) main" > /etc/apt/sources.list.d/php.list'
  when: ansible_os_family == 'Debian'

- name: Update packages
  become: true
  apt:
    update_cache=yes
  when: ansible_os_family == 'Debian'

- name: Install PHP
  apt:
    name: "{{ php_core_packages }}"
    state: present

- name: Install PHP Extensions
  apt:
    name: "{{ php_extension_packages }}"
    state: present
